<% include ../partials/cardFrameTop %>

<!-- color picker -->
<script src="/static/js/jscolor.min.js"></script>
<link rel="stylesheet" type="text/css" href="/static/css/v4_colorSelector.css">

<div class="card-head">
  <!-- exit button -->
  <a href="/v4/users/<%=user.cmid%>/primary/clients/open">
    <% include ../partials/cardExit %>
  </a>
  <div class="cardTitle">
    Apply Client Color Tag
  </div>
  <div class="cardSubtitle">
    Use color tags to help organize clients on the main clients view page.
  </div>
</div>

<div class="cardBody">

  <a href="/v4/users/<%=user.cmid%>/primary/colortags">
    <div class="manageColorsLink">
      <i class="fa fa-th-large" aria-hidden="true"></i>
      Manage colors
    </div>
  </a>

  <div class="coloredClientFrame">
    <div  class="clientNameBox" 
          style="background-color:<%=client.color_tag%>">
      <%= client.first + ' ' + client.last %>
    </div>
    <div class="clientColorNameSelected">
      <%= client.color_name %>
    </div>
  </div>

  <div class="colorList">
    <div  class="colorTag" 
          colorTagID=""
          colorTagName="None"
          style="background-color:#898989"></div>
    <div class="colorName">
      None
    </div>
  </div>

  <% colorTags.forEach(function (tag) { %>
    <div class="colorList">
      <div  class="colorTag" 
            colorTagID="<%= tag.color_tag_id %>"
            colorTagName="<%= tag.name %>"
            style="background-color:<%= tag.color %>"></div>
      <div class="colorName">
        <%= tag.name %>
      </div>
    </div>
  <% }) %>

  <center>
    <form method="POST" 
          action="/v4/users/<%=user.cmid%>/primary/clients/client/<%=client.clid%>/editcolortag">
      <input  type="hidden" 
              id="chosenColorTagID"
              name="colorTagID"
              value="">
      <input  type="submit" 
              class="formSubmit" 
              value="Update Client Color">
    </form>
  </center>

</div>


<script type="text/javascript">
  $(".colorList").click(function () {
    var colorTag = $(this).find(".colorTag");
    var colorTagID = colorTag.attr("colorTagID");
    var colorTagColor = colorTag.css("background-color");
    var colorTagName = colorTag.attr("colorTagName");

    // update selected value
    $("#chosenColorTagID").val(colorTagID);

    // update color and name on the block
    $(".clientNameBox").css("background-color", colorTagColor);
    $(".clientColorNameSelected").text(colorTagName)
  });
</script>



<% include ../partials/cardFrameBottom %>