<% include ../../partials/clientHubFrameTop %>

<!-- Load in addition CSS -->
<link rel="stylesheet" type="text/css" href="/static/css/v4_clientMessages.css">

<div class="leftBar">
  <div class="conversations">
    <% conversations.forEach(function (conversation) { %>
      <div class="conversation">
        <div class="subject">
          <%= conversation.subject ? conversation.subject : 'No Subject' %>
        </div>
        <div class="date">
          <div class="day"><%= moment.tz(conversation.updated, local_tz).format("DD/MM/YY") %></div>
          <div class="time"><%= moment.tz(conversation.updated, local_tz).format("hh:mm A") %></div>
        </div>
      </div>
    <% }) %>
  </div>
</div>


<div class="rightContent">

  <div class="messageStream">
    <% messages.forEach(function (message) { %>

      <div class="message <%= message.inbound ? 'inbound' : 'outbound' %>">
        <div class="content">
          <%= message.content %>
        </div>

        <div class="bottomRow">

          <% if (message.comm_type == 'cell') { %>
            <i class="fa fa-mobile" aria-hidden="true"></i>
          <% } %>

          <%= message.inbound ? 'Received via' : 'Sent to' %>
          <%= client.first + "'s" %> <%= message.commconn_name %>

          <span class="state">
            <%= message.tw_status %> on 
            <%= moment.tz(message.created, local_tz).format("MM/DD"); %> at 
            <%= moment.tz(message.created, local_tz).format("hh:mm A"); %>
          </span>
        </div>
      </div>

    <% }) %>
  </div>

</div>

<script type="text/javascript">
  // Intended to handle issue with height of content being dynamic in height
  $(".leftBar").height($(window).height() - 92);
  $(".rightContent").height($(window).height() - 92);
</script>

<% include ../../partials/hubFrameBottom %>